## 可能的选型：

``` 
半桥驱动 L6388ED013TR (驱动芯片，适用全N管拓扑，上管可以浮到600v，一个全桥需要两个这玩意驱动，甚至可以再搞一个把boost升级成同步整流boost）
H桥的MOS WST02N20B (200v 1A，够用了，也可考虑zvn4525，栅耐压极高，非常耐操，但只能过0.7A）
boost的MOS IRF640NPBF（200V 18A，便宜好用）
boost的电感 100uH 3A以上（不要用铁氧体磁芯，一大堆虚标的，一饱和就翘辫子。最好是铁硅铝磁芯）
单片机 esp32-c3（有蓝牙有wifi，便宜，不用usb转串口芯片可以直接编程。可买开发板模块，自带LDO和USB接口很方便。LDO也可考虑TPS73733DCQR，强在dorpout极低情况下也可工作，且输出可调，弱在贵而且耐压不高）
输出保护TVS PKC-136（160V击穿，够用）
栅极保护TVS VTVS17GSMF（20V，背靠背并联在mos管的栅极。）
二极管 MURS360T3G（600V 3A 老雇佣兵了，便宜好用）

``` 
---
## 可能的电路拓扑：
### 经典boost加全桥：
有手就行。可考虑12V输入，驱动和电源都用9v甚至12V，ldo降到3v3给单片机。
boost可单片机控制，输出必须得电阻网络分压再feedback回给单片机，但esp32的adc不是线性的需要特别注意，最好只用0到2V这个区间。也可用TL3843当外援，然后feed采样电阻网络先串一个固定的大电阻再串个数字电位器回馈到控制芯片的FB脚就行。注意控制boost电路产生的EMI


### 单极boost全桥：
![top2](https://github.com/PinkiePie1/D9Lab-Shocker/blob/main/images/topology.png)
---
好处器件更少，坏处控制更复杂

R1两端为输出。

输出正压时 Q2Q3开，Q1给PWM信号（比如打进去六个40u的方波脉冲然后关闭，打进去的脉冲数对应强度），Q4关

输出0压时  Q1Q2关，Q3Q4开。

输出负压时 Q1Q4开，Q2给PWM信号，Q3关

D1D2同时承担续流二极管和保护管的职责，所以应该是一个普通二极管和一个TVS并联（TVS正向特性很差）。电感两端应额外背靠背并联TVS防止Q1Q2同时开路而电感上还有残余电流导致打坏管子。
若需监控电流可直接V1上串电阻，出来的信号喂给支持R2R的差分放大器再过个RC滤波就是平均电流了，超过一定值直接给单片机中断
平常全桥可以输出0压给半桥驱动的自举电容充电。
